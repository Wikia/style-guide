<!--
Wikia Style Guide
Global Top Bar

Description:
This component provides a default top bar for Wikia websites and includes handling for logged in user state or a call
to action for anonymous users.

Example:
	<top-bar
		user-avatar-src="foo.png" user-profile-href="http://wwww.wikia.com" user-name="Wikia User"
		logo-href="http://www.wikia.com" logo-src="logo.svg" user-logged-in show-user-status>
		<h1>Hello World!</h1>
	</top-bar>

You can use the `showUserStatus` to control whether or not the callout for user registration/user logged in avatar is
shown or not. If `showUserStatus` is true, then the `userLoggedIn` attribute will control whether or not the
registration/signin callout is shown or whether the user avatar is shown.
-->
<dom-module id="top-bar">
	<style>
		[unresolved] {
			visibility: hidden;
		}

		:host {
			display: block;
			background-color: #fff;
			border-bottom: 1px solid #ccc;
			height: 46px;
			position: fixed;
			width: 100%;
			z-index: 9999999;
		}

		.logo {
			fill: #092344;
			width: 82px;
		}

		.user-status {
			float: right;
		}

		.user-status figure {
			margin-top: 3px;
			width: 36px;
			height: 36px;
			border-radius: 50%;
			overflow: hidden;
		}

		.user-status figure img {
			width: 100%;
			height: auto;
		}

		.register-cta {
			margin-top: 10px;
		}

		.overlay {
			/*@include perfect-square(100%);*/
			background-color: black;
			left: 0;
			position: fixed;
			top: 0;
			z-index: 1000; /* TODO - firgure out number from mercury app */
		}

		.drawer {
			list-style: none;
			overflow: hidden;
			position: fixed;
			right: 0;
			top: 0;
			transition: height .1s;
			width: 100%;
			z-index: 1000; /* TODO - firgure out number from mercury app */
		}

		.drawer a {
			/*@extend .touch-active;*/
			display: block;
			overflow: hidden;
			padding: 0.625rem 0.8125rem; /* TODO - this is done with rem-calc in mercury */
			text-overflow: ellipsis;
			width: 100%;
		}

		li {
			background-color: #fff;
			border-bottom: rem-calc(1) solid #d0d0d0;
		}

		.collapsed .drawer {
			height: 0;
		}

		.collapsed .overlay {
			opacity: 0;
			transition: visibility 0s 0.1s, opacity 0.1s; /* TODO - mercury uses variables for these values */
			visibility: hidden;
		}

		.visible .drawer {
			/* This is an arbitrary number larger than the combined height of the
			li children, so that transition animation works. With height: auto,
			it wouldn't be guaranteed to work. */
			height: 100px;
		}

		.visible .overlay {
			opacity: 0.5; /* TODO - mercury uses variables for these values */
			transition: opacity 0.1s; /* TODO - mercury uses variables for these values */
			visibility: visible;
		}
	</style>

	<template>
		<div class="row">
			<div class="large-12 columns">
				<a href="{{logoHref}}"><img src="{{logoSrc}}" alt="Wikia" class="logo left"></a>

				<!-- Catch all for transcluded content -->
				<content select=".content"></content>

				<template is="dom-if" if="{{showUserStatus}}">
					<div class="user-status collapsed">
						<template is="dom-if" if="{{userLoggedIn}}">
							<a href="{{userAvatarHref}}">
								<figure>
									<img src="{{userAvatarSrc}}" alt="{{userName}}">
								</figure>
							</a>
							<div class="overlay"></div>
							<ul class="drawer">
								<content select=".drawer-li"></content>
							</ul>
						</template>

						<template is="dom-if" if="{{!userLoggedIn}}">
							<div class="register-cta">
								<a href="#">Register</a> or <a href="#">Login</a>
							</div>
						</template>
					</div>
				</template>
			</div>
		</div>
	</template>
</dom-module>

<script>
	(function () {
		Polymer({
			is: 'top-bar',
			properties: {
				userAvatarSrc: String,
				userProfileHref: String,
				userName: String,
				logoHref: String,
				logoSrc: String,
				userLoggedIn: {
					type: Boolean,
					value: false,
					reflectToAttribute: true
				},
				showUserStatus: {
					type: Boolean,
					value: false
				}
			}
		});
	}());
</script>
